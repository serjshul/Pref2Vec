# Модель Pref2Vec
Модель векторизации пользовательских предпочтений, спроектированная и реализованная в рамках выпускной квалификационной работы **«Применение методов обработки естественного языка в рекомендательных системах»**. Предлагается в качестве основы гибридной рекомендательной системы.

## Адаптация модели Doc2Vec для применения в рекомендательных системах
Одна из основных особенностей предлагаемой модели – **расширение эмбеддингов**, формируемых при помощи модели Doc2Vec, которое позволяет отобразить в эмбеддингах как и семантику рассматриваемых объектов, так и семантику взаимодействия пользователей с ними. Подход позволяет решить проблему наличия контекстной зависимости.

Также предлагается **неклассическое применение задачи кластеризации**, при помощи которой решаются проблемы разреженности, масштабирования и проблема «серых овец».

Все объекты, с которыми взаимодействовал пользователь, делятся на категории взаимодействий. Расширенные эмбеддинги всех категорий составляют пользовательское пространство эмбеддингов – `UES`. Алгоритм обработки одной из таких категорий представлен на следующей схеме:

![image](https://github.com/user-attachments/assets/e65fae50-9d88-4470-992a-3ae3fbe6a9b2)

Реализован класс **User Embeddings Space** (`UES`), который позволяет векторизовать предпочтения конечного пользователя. Алгоритм работы класса:
1) Расчёт эмбеддингов при помощи модели **Doc2Vec**;
2) Расширение эмбеддингов;
3) Поиск центров категорий взаимодействий при помощи метода **K-Medoids**.

![image](https://github.com/user-attachments/assets/e87344be-269f-4c10-9812-e1d1daa468fc)

## Алгоритм построения рекомендаций
Сначала рассчитывается **корпус** пользовательских пространств эмбеддингов. Алгоритм построения рекомендаций состоит в **анализе** корпуса с целью извлечении возможных рекомендаций из ближайших пользовательских пространств эмбеддингов.

![image](https://github.com/user-attachments/assets/254ebe3f-46e6-4ead-bb5b-f1636193c984)

Реализована модель `Pref2Vec`, которая позволяет:
- Построить корпус экземпляров `UES`;
- Исследовать корпус с целью поиска схожих пространств;
- Строить рекомендации посредством поиска схожих пользовательских предпочтений.

Модель `Pref2Vec` и класс `UES` расширяют функциональность библиотеки **Gensim**.

## Исходные данные

Выбран набор данных книжного веб-сервиса [«GoodReads»](https://mengtingwan.github.io/data/goodreads.html) – сайта, предоставляющего свободный доступ к обширной базе данных книг, аннотаций и различных обзоров.

Были произведены: 
- Предобработка исходных наборов данных;
- Формирование корпуса книжных аннотаций;
- Формирование датасета пользовательских предпочтений.

## Тестирование модели

ЯРС тестировалось при помощи разработанного класса `Evaluator` на 2 датасетах посредством вычисления метрик `Recall@k` и `NCDG@k` (`k` – длина списка рекомендаций).

**Условия тестирования**: 200 пользователей, корпус Pref2Vec – 100 000 пользовательских пространств.
|                    | Recall@10 | Recall@15 | Recall@20 | NDCG@10 | NDCG@15 | NDCG@20 |
|--------------------|-----------|-----------|-----------|---------|---------|---------|
| GoodReads-Children | 0,0904    | 0,1056    | 0,1585    | 0,0996  | 0,0769  | 0,0628  |
| GoodReads-Comics   | 0,0542    | 0,1033    | 0,1627    | 0,1140  | 0,1099  | 0,0933  |

Полученные результаты сравнимы с показателями современных моделей, что говорит о **конкурентоспособности** разработанного ЯРС. 

![image](https://github.com/user-attachments/assets/cd2e8979-fad2-49a5-a7d9-cc5f1785b5c4)

